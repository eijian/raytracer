この講演は2つの部分で構成されています。
最初の部分では、フォトンマッピングとバイアスの問題を確認します。これは、レンダリングされたイメージに一貫したエラーがあることを意味します。
  この問題は、制限のない公平なプログレッシブフォトンマッピングによって最近解決されました。 2番目の部分では、よりエレガントで実装が簡単で、より一般的なプログレッシブフォトンマッピングの確率的アプローチを提案します。



9
これは、フォトンマッピングを使用してレンダリングされた同じシーンです。
  おそらく、ノイズははるかに少ないです。

12
この半径が、フォトンマッピングの最大の批判の源であり、偏りがあります。
放射輝度の推定には畳み込みまたは内挿が含まれますが、これはしばしば不鮮明さをもたらすため、バイアスと呼ばれる一貫したエラーがあります。

15
フォトンマッピングにはバイアスがかかっていますが、これはまだ一貫した方法です。つまり、サンプル数が無限であれば、バイアスは消滅し、結果のイメージは正しいことを意味します。
しかし、ここにフォトンマッピングの実際的な問題があります。
  ライトパスを表すフォトンは2つのステージ間でキャッシュする必要があるため、画像の品質は使用可能なメモリによって制限されます。

16
2008年、ハチスカらは、このメモリのボトルネックをプログレッシブフォトンマッピングで解決しました。
プログレッシブフォトンマッピングのアイデアは、一度に限られた数のフォトンを使用して、一連のフォトンマッピング結果を段階的に更新することです。

17
プログレッシブフォトンマッピングは反復的な方法です。
反復の前に、目の光線が追跡され、場所に保存されます。
その後、反復ごとに、新しい（独立した）光子がトレースされます。
最後に、最も重要なステップは、カーネル半径が減少するときです。
そして、新しい反復が始まります。

18
プログレッシブフォトンマッピングの鍵は、バイアスがなくなるように、反復ごとにカーネル半径を小さくすることです。

21
これは、放射輝度推定のすべての場所、つまり収集された光子の数、フラックス、およびカーネル半径に格納されている統計を使用して行われます。

22
反復iからi + 1への正確な半径の減少は、この更新ルールを使用して計算されます。これには、収集された光子の数など、これらのローカル統計の使用が含まれます。

23
2009年に、フォローアップ作業で、ハチスカとジェンセンは確率的プログレッシブフォトンマッピングへの方法を一般化しました。
光沢のある反射、被写界深度、モーションブラーなどの追加の効果が含まれています。

24
確率的プログレッシブフォトンマッピングの主な変更点は、目の光線を1回追跡する代わりに、反復ごとに光線が追跡されることです。

27
局所的な統計を必要とせず、並列化するのは簡単なプログレッシブフォトンマッピングの新しい導出が見つかりました。
収束解析も提供します。
さらに、プログレッシブフォトンマッピングの再定式化は、任意の放射輝度推定カーネルに一般化されます。
そして最後に、体積フォトンマッピングやビーム放射輝度推定の最近の作業など、他の放射輝度推定に一般化するのは簡単です。

28
放射輝度推定の確率的分析から始めましょう。
放射輝度推定は、モンテカルロ積分です。
N_eは放出された光子の数です。
N_sは、保存されているフォトンの数です。
k_rは半径rのカーネルです。
x_iは光子の位置で、gamma_iは光子のパワーであり、すでにBRDFであらかじめ乗算されており、反射放射輝度になります。
モンテカルロ積分は確率的手法であるため、放射輝度推定の統計を見ることができます。

30
つまり、ノイズとバイアス。
放射輝度推定のノイズは、半径の2乗に反比例することがわかります。
直観的には、半径を大きくすると、より多くの光子にわたって平均化する効果があるため、ノイズが減少することは明らかです。
一方、バイアスは半径の2乗に比例します。
この場合、半径を大きくするとコースティクスのような機能が多くなるため、バイアスが大きくなります。
半径が0の場合にのみバイアスが消えることに注意してください。
固定半径の場合、この古典的なトレードオフがあります。このトレードオフでは、滑らかさと不偏さの両方を同時に達成することはできません。

32
元のプログレッシブフォトンマッピングのアイデアに従って、メモリのボトルネックを解消するために、レンダリングを複数の反復に分割したいと思います。
反復を組み合わせる最も簡単な方法は、画像を平均化することです。 論文では、平均放射輝度推定値が収束すると、平均画像が収束することを示しています。
放射輝度の推定値を多くの反復にわたって平均化するとどうなるか見てみましょう。

33
反復ごとのノイズは一定のままですが、平均のノイズは1 / Nで消失し、平均化された画像はより滑らかになります。
これは素晴らしいことですが、バイアスはどうですか？
反復ごとのバイアスは一定のままであり、残念ながら、平均放射輝度推定値のバイアスも一定のままです。
これは驚くべきことではありません。単に画像を平均化するだけであり、これによりノイズは減少しますが、バイアスは減少しません。

34
平均の偏りを減らす唯一の方法は、カーネル半径を減らすことです。
反復ごとのバイアスだけでなく、半径が連続的に減少する場合、
しかし、平均のバイアスも消えます。
しかし、前に見たように、半径を小さくすると、
繰り返しが増加します。
プログレッシブフォトンマッピングのコツは、平均放射輝度推定のノイズがまだ限界で消えるように、半径を十分に遅くすることです。
要約すると、平均のノイズとバイアスの両方が限界で消失するのに十分なほど遅くなる半径シーケンスを探します。

36
この式で、平均輝度推定のノイズとバイアスの両方が消えるこの細い線を歩くことができる半径シーケンスがこの式で与えられます。
詳細な証拠は、私たちの論文にあります。
提案された半径シーケンスは再帰的に定義されます。
iは反復数、alphaは0〜1のパラメーターでなければなりません。

38
提案された半径シーケンスを使用して、次の漸近収束を見つけました。
平均放射輝度推定のノイズは、1 / N ^ alphaに比例して消失します。Nは反復回数です。
平均放射輝度推定値のバイアスは、1 / N ^（1-alpha）に比例して消失します。
ここで、アルファがノイズとバイアスの収束速度をどのように制御するかを見ることができます。
青い曲線のような小さなアルファ値はノイズをゆっくりと減らしますが、バイアスはすぐに消えます。
一方、大きなアルファである茶色の曲線はノイズを迅速に低減しますが、バイアスはゆっくり下がります。

40
また、この漸近収束を経験的に検証しました。
前のシーンで取得した一連の放射輝度推定値の収束を確認します。
ここで、実線は、測定されたノイズと2つの異なるアルファ値のバイアスです。
点線は漸近曲線です。

41
半径シーケンスは、彼が提案した半径更新ルールに似ていますが、収集された光子数や局所的な光子密度などの局所的な統計とは完全に独立しているという重要な違いがあります。
実際、局所的に一定の光子密度の場合、半径シーケンスはハチスカらのものと同じであることを論文で示しています。

42
再帰式を使用する代わりに、半径シーケンスを明示的に記述することもできます。
r_1は、シーケンスを固定する初期参照半径です。
Bは、二項係数に関連するオイラーベータ関数を表します。

43
この式を使用して、次のアルゴリズムを提案します。
このアルゴリズムは、多数のフォトンマッピングの反復に対する単純なループです。
ここでの唯一の専門は、カーネル半径の決定方法です。
すべての反復で、標準のフォトンマッピングと同様に、フォトンをトレースしてフォトンマップに保存することで最初のパスを実行します。
次に、2回目のパスで、追跡されたすべてのアイレイについて、基準半径を決定し、前に示した明示的な式を使用して現在の反復の半径を計算します。
次に、この半径を使用して、範囲クエリで放射輝度を推定します。

45
基準半径を定義するには、さまざまな戦略があります。
最も簡単な解決策は、この参照半径をグローバルに定義することです。
この場合、実装ははるかに簡単になります。 半径シーケンス全体を取り出して、パラメーターとしてフォトンマッパーに渡し、効果的にブラックボックスとして扱うことができます。
同時に、プログレッシブフォトンマッピングアルゴリズムはスクリプトに崩壊します。

47
元のプログレッシブフォトンマッピングでは、ローカル統計を1つの反復から次の反復に引き継ぐ必要があるため、反復は相互に依存していました。
一方、反復は統計に依存しないため、並行して実行できます。

49
概念実証として、PBRTをブラックボックスとして駆動し、クラスターで実行するスクリプトを作成しました。
すべてのPBRTインスタンスには、半径シーケンスから半径が与えられました。 次に、結果の画像を単一のマシンで平均化しました。

50
ここに結果が表示されます。 予想どおり、カーネル半径が小さい場合、レンダリングされたイメージはノイズが多くなります。

51
しかし、画像を平均化するとどうなるか見てみましょう。
ここでは、最初の画像のみが表示されています。
これで、最初の10個の画像が平均化されました。 すでにはるかに少ないノイズ。
これで、最初の100個の画像の平均が得られました。
そして最後に、目に見えるノイズやバイアスのない1000以上の画像。

52
品質面では、この方法は従来のプログレッシブフォトンマッピングと同等です。
ここでは、両方の方法にグローバル参照半径を使用しました。
従来のプログレッシブフォトンマッピングと私たちの方法の違いは、ノイズのみです。

54
プログレッシブフォトンマッピングの再定式化はより一般的です。
放射輝度の推定に任意のカーネルを使用できます。
最も適切なカーネルを使用するとどうなるか見てみましょう。

55
ここでは、カーネルを表示するために反復ごとに1,000光子のみを使用します。
この場合でも、何度も繰り返した後、画像シーケンスが収束することがわかります。

57
最後に、半径シーケンスと分析の導出は、参加メディアにも拡張されます。
体積フォトンマッピングでは、放射輝度は表面ではなく、体積で定義されます。
したがって、放射輝度推定に使用されるカーネルは3次元になります。

58
分析の後、半径の順序で半径の指数を3に置き換えるだけで、3次元領域で統合できます。

59
以下に例を示します。 これは水で満たされたコーネルボックスです。
最初は、わずか200万個の光子で、ノイズしか見えません。

60
しかし、十分なフォトンを撮影した場合。

61
神の光線を見始めます。

62
そして最終的に、1000回の反復と20億の光子の後、鋭いコースティクスが現れ、ノイズがなくなります。














